---
title: "statistical_process_control"
author: "Filippo Maganza"
date: "`r Sys.Date()`"
output: 
  bookdown::pdf_book:
    includes:
      in_header: preamble.tex
    pandoc_args: --top-level-division=chapter
header-includes:
- \usepackage{amsthm}
- \newtheorem{definition}{Definition}
- \newtheorem{lemma}{Lemma}
- \newtheorem{theorem}{Theorem}
- \newtheorem{example}{Example}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Statistical process control

Statistical process control (SPC) is a set of tools useful in achieving process stability and improving capability through the reduction of variability.

## Introduction

### In control and out of control processes

```{definition, name="In control process"}
A process that is operating with only chance causes of variation.
```

Besides variability due to randomness (also called background noise), other kinds of variability may occasionally be present in the output of a process. This variability usually arises from three sources: 
  
*  improperly adjusted or controlled machines
*  operator errors
*  defective raw material

```{definition, name="Assignable cause of variation"}
A cause of process variability that is not part of the chance cause pattern.
```

Variability with an assignable cause is generally large when compared to the background noise, and it usually represents an unacceptable level of process performance.

```{definition, name="Out of control process"}
A process that is operating in the presence of assignable causes of variation.
```

A major objective of statistical process control is to quickly detect the occurrence of assignable causes of process shifts so that investigation of the process and corrective action may be undertaken before many nonconforming units are manufactured.

## Control charts

The most important use of a control chart is **on-line process surveillance to improve the process**. 

Furthermore, control charts have had a long history of use in U.S. industries. There are at least five reasons for their popularity:

*  **Control charts are a proven technique for improving productivity.** A successful control chart program will reduce scrap and rework, which are the primary productivity killers in any operation. If you reduce scrap and rework, then productivity increases, cost decreases, and production capacity (measured in the number of good parts per hour) increases.
*  **Control charts are effective in defect prevention.** The control chart helps keep the process in control, which is consistent with the “do it right the first time” philosophy. It is never cheaper to sort out “good” units from “bad” units later on than it is to build it right initially. 
*  **Control charts prevent unnecessary process adjustment.** If process operators adjust the process based on periodic tests unrelated to a control chart program, they will often overreact to the background noise and make unneeded adjustments. In other words, the control chart is consistent with the “if it isn’t broken, don’t fix it” philosophy.
*  **Control charts provide diagnostic information.** Frequently, the pattern of points on the control chart will contain information of diagnostic value to an experienced operator or engineer. This information allows the implementation of a change in the process that improves its performance.
*  **Control charts provide information about process capability.** Control charts are among the most important management control tools; they are as important as cost controls and material controls. 

## Control charts components
A typical control chart (Shewhart control chart) is shown in Fig. 2. The control chart displays the quality characteristic that has been measured or computed from a sample versus the sample number or time. The chart contains a center line that represents the average value of the quality characteristic corresponding to the in-control state. Two other horizontal lines, called the upper control limit (UCL) and the lower control limit (LCL), are also shown on the chart. These control limits are chosen so that if the process is in control, nearly all of the sample points will fall between them.

## Out of control indicators
As long as the points plot within the control limits, the process is assumed to be in control, and no action is necessary. However, **a point that plots outside of the control limits** is interpreted as evidence that the process is out of control, and investigation and corrective action are required to find and eliminate the assignable cause or causes responsible for this behavior. 

Even if all the points plot inside the control limits, if they behave in a systematic or nonrandom manner, then this could be an indication that the process is out of control. Methods for looking for sequences or **nonrandom patterns** can be applied to control charts as an aid in detecting out-of-control conditions.

### Out of Control Action Plan (OCAP)
A very important part of the corrective action process associated with control chart usage is the out-of-control-action plan (OCAP). An OCAP is a flow chart or text-based description of the sequence of activities that must take place following the occurrence of an activating event. These are usually out-of-control signals from the control chart. 
![OCAP for hard-bake process](images/OCAP.png)

## Types of control charts 
Control charts may be classified into two general types. 

If the quality characteristic can be measured and expressed as a number on some continuous scale of measurement, it is usually called a variable. Control charts for central tendency and variability of variables are collectively called **variables control charts**. 

Many quality characteristics are not measured on a continuous scale or even a quantitative scale. In these cases:

* we may judge each unit of product as either conforming or nonconforming on the basis of whether or not it possesses certain attributes, or
* we may count the number of nonconformities (defects) appearing on a unit of product.

Control charts for such quality characteristics are called **attributes control charts**. 

## Control chart design
To design a control chart it is necessary to select:

* sample size,
* control limits (UCL and LCL)
* frequency of sampling

### Shewhart control chart

Let $w$ be a sample statistic that measures some quality characteristic of interest, and suppose that
the mean of $w$ is $\mu_w$ and the standard deviation of $w$ is $\sigma_w$. Then, the Shewhart control chart center line,  upper control limit, and lower control limit are:

* $UCL = \mu_w + L \sigma_w$
* $LCL = \mu_w - L \sigma_w$

where L is the distance of the control limits from the center line, expressed in standard deviation units. Very coommonly $L$ is set to 3 (three-sigma rule). 

### Connection with hyphothesis testing and confidence intervals.

In Shewhart control chart, the interval given by $\mu_w \pm L \sigma_w$ is a $100(2*\phi(1-L))%$ confidence interval for each sample average.


